!function(){var a=angular.module("myApp",["ngRoute"]);a.run(["$rootScope","$location","$route","Auth",function(a,b,c,d){a.logOut=function(){d.logOut()},a.$on("$routeChangeStart",function(c,e,f){var g=d.isLoggedIn();a.isLoggedIn=g;var h=e.$$route&&e.$$route.isAuthNeeded&&!g;h&&b.path("/login")})}]),a.config(["$routeProvider",function(a){a.when("/profile",{templateUrl:"/partials/user-profile.html",controller:"profileCtrl",isAuthNeeded:!0}).when("/login",{templateUrl:"/partials/login.html",controller:"loginCtrl",isAuthNeeded:!1}).when("/register",{templateUrl:"/partials/register.html",controller:"registerCtrl",isAuthNeeded:!1}).otherwise("/login")}]),a.config(["$httpProvider",function(a){a.interceptors.push("HttpAuthIntreptorServ")}]),a.directive("navActive",["$rootScope","$window",function(a,b){function c(c,d,e){var f=d.parent();"LI"===f[0].nodeName&&a.$on("$routeChangeSuccess",function(a){d[0].href===b.location.href?f.addClass("active"):f.removeClass("active")})}return{restrict:"A",link:c}}])}(),function(){function a(a,b){a.loginUser=function(){b.logIn(a.user.email,a.user.password).then(function(b){b&&b.message&&!b.success&&(a.message=b.message)})}}angular.module("myApp").controller("loginCtrl",["$scope","Auth",a])}(),function(){function a(a){}angular.module("myApp").controller("mainCtrl",["$scope",a])}(),function(){function a(a,b){b.get().then(function(b){console.log(b),a.up=b})}angular.module("myApp").controller("profileCtrl",["$scope","Profile",a])}(),function(){function a(a,b){a.registerUser=function(){b.register(a.user.email,a.user.password).then(function(b){b&&b.message&&!b.success&&(a.message=b.message)})}}angular.module("myApp").controller("registerCtrl",["$scope","Auth",a])}(),function(){function a(a,b,c){function d(d,e){return a.post("/register",{email:d,password:e}).then(function(a){if(a.data&&a.data.token){var d={token:a.data.token};c.saveUser(d),b.path("/profile")}return a.data})}function e(){return c.getToken()}function f(d,e){return a.post("/login",{email:d,password:e}).then(function(a){if(a.data&&a.data.token){var d={token:a.data.token};c.saveUser(d),b.path("/profile")}return a.data})}function g(){c.deleteUser()}return{register:d,isLoggedIn:e,logOut:g,logIn:f}}angular.module("myApp").factory("Auth",["$http","$location","LocalStorageServ",a])}(),function(){function a(a){return{request:function(b){b.headers=b.headers||{};var c=a.getToken();return c&&(b.headers["x-access-token"]=c,b.headers.Authorization=c),b}}}angular.module("myApp").factory("HttpAuthIntreptorServ",["LocalStorageServ",a])}(),function(){function a(){function a(a){a&&"object"==typeof a&&(a=JSON.stringify(a)),sessionStorage.setItem("user",a)}function b(){sessionStorage.removeItem("user")}function c(){var a=sessionStorage.user;return a?JSON.parse(a):null}function d(){var a=sessionStorage.user;return a?JSON.parse(a).token:null}return{saveUser:a,getUser:c,getToken:d,deleteUser:b}}angular.module("myApp").factory("LocalStorageServ",[a])}(),function(){function a(a){function b(){return a.get("/api/me").then(function(a){return a.data})}return{getUser:b,get:b}}angular.module("myApp").factory("Profile",["$http",a])}();